(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{477:function(s,t,e){s.exports=e.p+"assets/img/julia.cea00060.jpg"},478:function(s,t,e){s.exports=e.p+"assets/img/duplicate-plugin.ecb61b19.png"},479:function(s,t,e){s.exports=e.p+"assets/img/yelling.2ce13a40.jpg"},540:function(s,t,e){"use strict";e.r(t);var a=e(19),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("繁體中文 | "),a("RouterLink",{attrs:{to:"/en/2020/01/01/caveats-about-building-npm-packages/"}},[s._v("English")])],1),s._v(" "),a("p",[s._v("新年第一天來回顧我去年製作 npm package 犯的傻事，以下將列出三點可能會對你有幫助的注意事項。")]),s._v(" "),a("h2",{attrs:{id:"重複的-npm-package"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重複的-npm-package"}},[s._v("#")]),s._v(" 重複的 npm package")]),s._v(" "),a("p",[s._v("這是我在做"),a("a",{attrs:{href:"https://github.com/newsbielt703/vuepress-plugin-disqus-comment",target:"_blank",rel:"noopener noreferrer"}},[s._v("vuepress-plugin-disqus-comment"),a("OutboundLink")],1),s._v("遇到的傻事，這 plugin 一個開始的名字是"),a("code",[s._v("vuepress-plugin-disqus")]),s._v("。那時候我寫完時，很開心的按下"),a("code",[s._v("yarn publish")]),s._v("，卻在 Terminal 上看到：")]),s._v(" "),a("p",[a("code",[s._v('error Couldn\'t publish package: "https://registry.yarnpkg.com/vuepress-plugin-disqus: You do not have permission to publish \\"vuepress-plugin-disqus\\". Are you logged in as the correct user?"')])]),s._v(" "),a("img",{staticClass:"align-center",attrs:{src:e(477),width:"500px"}}),s._v(" "),a("p",[s._v("愣住好一陣子後，才突然想到，趕快上"),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("npmjs.com"),a("OutboundLink")],1),s._v("收尋"),a("code",[s._v("vuepress-plugin-disqus")]),s._v("，果然：")]),s._v(" "),a("p",[a("img",{attrs:{src:e(478),alt:"Duplicate plugin"}})]),s._v(" "),a("p",[s._v("早就有人做這個套件了...")]),s._v(" "),a("p",[s._v("奉勸各位開始埋頭苦幹前先上"),a("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("npmjs.com"),a("OutboundLink")],1),s._v("找找是不是已經有相關 package，也不是說已經有了就不能做，不過你可以衡量究竟是要發 PR 幫現有的 package 做改善，還是自己再造一個輪子。")]),s._v(" "),a("h2",{attrs:{id:"善用-npm-link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#善用-npm-link"}},[s._v("#")]),s._v(" 善用 npm link")]),s._v(" "),a("p",[s._v("這是個更智障的傻事了。我在 package 裡寫了 demo，當然是直接載入本地的程式，如："),a("code",[s._v('require("../../src/index"')]),s._v("，demo 都如我預期我就發佈了，當我用其他專案安裝這個 package 後才發現根本不能運作，打開 package.json 檢查：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress-plugin-disqus-comment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Adding Disqus comments to VuePress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"keywords"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"comment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"disqus"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plugin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"homepage"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://vuepress-plugin-disqus.netlify.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"bugs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/newsbielt703/vuepress-plugin-disqus/issues"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"repository"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"newsbielt703/vuepress-plugin-disqus"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"license"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MIT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"author"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Billyyyyy3320 <newsbielt703@gmail.com>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"main"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build:docs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress build docs --temp docs/.temp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev:docs"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress dev docs --temp docs/.temp"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"vue-disqus"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.0.5"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"devDependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"vuepress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"vuepress-types"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^0.3.0"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("而這是我的目錄：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("├── LICENSE\n├── README.md\n├── docs\n│   └── README.md\n├── package.json\n├── src\n│   ├── enhanceAppFile.js\n│   └── index.js\n└── yarn.lock\n")])])]),a("p",[a("code",[s._v("main")]),s._v(" 指定的位置根本不對啊！！")]),s._v(" "),a("img",{staticClass:"align-center",attrs:{src:e(479),width:"400px"}}),s._v(" "),a("p",[s._v("利用"),a("a",{attrs:{href:"https://docs.npmjs.com/cli/link",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm link"),a("OutboundLink")],1),s._v(" or "),a("a",{attrs:{href:"https://yarnpkg.com/lang/en/docs/cli/link/",target:"_blank",rel:"noopener noreferrer"}},[s._v("yarn link"),a("OutboundLink")],1),s._v(" 可以將一個 package 連結至另一個專案，如果我當初有使用就會提早發現了。")]),s._v(" "),a("p",[s._v("你可能不會跟我一樣犯這種低級錯誤，但是至少記得發布前善用"),a("code",[s._v("npm link")]),s._v(" or "),a("code",[s._v("yarn link")]),s._v("甚至"),a("a",{attrs:{href:"https://github.com/whitecolor/yalc",target:"_blank",rel:"noopener noreferrer"}},[s._v("Yalc"),a("OutboundLink")],1),s._v("來測試你的 package 是否正常。")]),s._v(" "),a("h2",{attrs:{id:"npmignore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npmignore"}},[s._v("#")]),s._v(" "),a("code",[s._v(".npmignore")])]),s._v(" "),a("p",[s._v("避免不需要的檔案被發布有三個方法，"),a("code",[s._v(".gitignore")]),s._v("或"),a("code",[s._v(".npmignore")]),s._v("或"),a("code",[s._v("package.json")]),s._v("裡的"),a("code",[s._v("file")]),s._v("屬性。")]),s._v(" "),a("p",[s._v("假設你的"),a("code",[s._v(".gitignore")]),s._v("長這樣：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("node_modules\nmy_secret\n")])])]),a("p",[s._v("那麼"),a("code",[s._v("node_modules")]),s._v("跟"),a("code",[s._v("my_secret")]),s._v("不只會被 git 忽略，也不會被 npm 上傳。")]),s._v(" "),a("p",[s._v("除非你的 package 裡有"),a("code",[s._v(".npmignore")]),s._v("，常見的像是你寫了測試，測試需要被 git 存儲，但是不需要被 npm 上傳，這時候你可就會用到"),a("code",[s._v(".npmignore")]),s._v("。你可能會寫成：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tests\n")])])]),a("p",[s._v("那就慘囉"),a("code",[s._v("my_secret")]),s._v("會被上傳，只要有"),a("code",[s._v(".npmignore")]),s._v("，"),a("code",[s._v(".gitignore")]),s._v("就不會再被 npm 參考，所以確保你有列出所有不想被發布的檔案：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("my_secret\ntests\n")])])]),a("p",[s._v("這點我沒有經歷切身之痛，是看到"),a("a",{attrs:{href:"https://medium.com/@jdxcode/for-the-love-of-god-dont-use-npmignore-f93c08909d8d",target:"_blank",rel:"noopener noreferrer"}},[s._v("這篇"),a("OutboundLink")],1),s._v("才去了解的，他很氣，很重要。")]),s._v(" "),a("p",[s._v("值得一提的是"),a("code",[s._v("node_modules")]),s._v("不需要寫在"),a("code",[s._v(".npmignore")]),s._v("裡，他會自動被忽視，詳情請見"),a("a",{attrs:{href:"https://docs.npmjs.com/misc/developers#keeping-files-out-of-your-package",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"package-跟-module-差異"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package-跟-module-差異"}},[s._v("#")]),s._v(" package 跟 module 差異")]),s._v(" "),a("p",[s._v("為了寫這篇 blog，我才知道 package 跟 module 差在哪裡:")]),s._v(" "),a("p",[s._v("簡單來說 package 需要有 "),a("code",[s._v("package.json")]),s._v(" 來描述這個 package 的詳細資訊，而 module 可能只是個可以被載入的檔案或是目錄，不一定會有"),a("code",[s._v("package.json")]),s._v("，就像只有是哈士奇一定是狗，但是狗不一定是哈士奇，更多資訊請看"),a("a",{attrs:{href:"https://docs.npmjs.com/about-packages-and-modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("新年快樂。")])])}),[],!1,null,null,null);t.default=n.exports}}]);